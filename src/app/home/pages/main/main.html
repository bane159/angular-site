<app-layout>
  <!-- Search Results Header -->
  @if (isSearchMode) {
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div>
        <h1 class="h3">Search Results</h1>
        <p class="text-muted">Results for: "{{ searchQuery }}"</p>
      </div>
      <div class="d-flex gap-2">
        <button class="btn btn-outline-secondary" (click)="clearSearch()">
          <i class="fas fa-times me-1"></i>Clear Search
        </button>
        <a class="btn btn-primary" [routerLink]="['/ask-question']">Ask Question</a>
      </div>
    </div>
  } @else {
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1 class="h3">Popular questions</h1>
        <a class="btn btn-primary" [routerLink]="['/ask-question']">Ask Question</a>
    </div>
  }
  
  <div class="question-stats mb-3">
      <span class="text-muted">{{ answeredQuestionsCount }} Answered questions</span>
  </div>

  @if (!isSearchMode) {
    <div class="filter-tabs mb-3">
        <ul class="nav nav-pills">
        <li class="nav-item">
            <button class="nav-link" [class.active]="filterCriteria === 'newest'" (click)="onFilterChange('newest')">All</button>
        </li>
        <!-- <li class="nav-item">
            <button class="nav-link" [class.active]="filterCriteria === 'active'" (click)="onFilterChange('active')">Active</button>
        </li> -->
        <li class="nav-item">
            <button class="nav-link" [class.active]="filterCriteria === 'answered'" (click)="onFilterChange('answered')">Answered</button>
        </li>
        <li class="nav-item">
            <button class="nav-link" [class.active]="filterCriteria === 'unanswered'" (click)="onFilterChange('unanswered')">Unanswered</button>
        </li>

        <li class="nav-item " style="max-height: 200px;">
            <select name="tag" id="" class="form-select" 
            #tagFilter
            [value]="selectedTag"
            (change)="onTagChange(tagFilter.value)">
              <option value="all">All Tags</option>
              @for(tag of tags; track tag) {
                  <option value="{{tag.name}}">{{tag.name}}</option>
              }
          </select>
        </li>

        </ul>
    </div>
  }


   @if (isLoading) {
    <div class="d-flex justify-content-center my-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
    }
  <!-- Questions List -->
   @if(questions.length == 0) {
      <div class="text-center py-5">
        @if (isSearchMode) {
          <p>No questions found for "{{ searchQuery }}".</p>
          <button class="btn btn-primary" (click)="clearSearch()">View Popular Questions</button>
        } @else {
          <p>No questions found.</p>
        }
      </div>
    }
  <app-home-question-wrapper>
      @for(question of questions; track question.id) {
          <app-home-question [question]="question"></app-home-question>
      }
  </app-home-question-wrapper>
</app-layout>





